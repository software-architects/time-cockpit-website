---
layout: blog
title: Sample Code for TypeScript Article in Windows.Developer Magazine
teaser: I am currently writing an article about TypeScript for the upcoming issue of the German Windows.Developer magazine. It contains a larger code sample demonstrating some key concepts of the new language. 
author: Rainer Stropek
date: 2012-06-02
bannerimage: 
permalink: /blog/2012/11/02/Sample-Code-for-TypeScript-Article-in-WindowsDeveloper-Magazine
---

<p xmlns="http://www.w3.org/1999/xhtml">I am currently writing an article about <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a> for the upcoming issue of the German <a href="http://it-republik.de/dotnet/windowsdeveloper-ausgaben" target="_blank">Windows.Developer</a> magazine. It contains a larger code sample demonstrating some key concepts of the new language. Some readers might be interested in playing with the sample code in TypeScript's <a href="http://www.typescriptlang.org/Playground/" target="_blank">Playground</a>. Probably they do not want to type in the sample code. Therefore I publish the code in this article.</p><h2 xmlns="http://www.w3.org/1999/xhtml">OO Concepts in TypeScript</h2><p xmlns="http://www.w3.org/1999/xhtml">The first sample deals with the TypeScript language. It demonstrates some OO concepts of the language:</p>{% highlight javascript %}// Define a top-level module&#xA;module CrmModule {&#xA;  // Define an interface that specifies what a person must consist of.&#xA;  export interface IPerson {&#xA;    firstName: string;&#xA;    lastName: string;&#xA;  }&#xA;  &#xA;  // Note that Person would not need to specify &quot;implements IPerson&quot; &#xA;  // explicitely. Even if the &quot;implements&quot; clause would not be there, &#xA;  // Person would be compatible with IPerson because of structural subtyping.&#xA;  export class Person implements IPerson {&#xA;    private isNew: bool;       // a private member only accessible inside Person&#xA;    public firstName: string;  // a public member accessible from outside&#xA;    &#xA;    // Here you see how to define a constructor&#xA;    // Note the keyword &quot;public&quot; used for parameter &quot;lastName&quot;. It &#xA;    // makes &quot;lastName&quot; a public property. &quot;firstName&quot; is assigned manually.&#xA;    constructor(firstName: string, public lastName: string) {&#xA;      this.firstName = firstName;&#xA;    }&#xA;    &#xA;    // A public method...&#xA;    public toString() {&#xA;      return this.lastName + &quot;, &quot; + this.firstName;&#xA;    }&#xA;    &#xA;    // A public get accessor...&#xA;    public get isValid() {&#xA;      return this.isNew || &#xA;        (this.firstName.length &gt; 0 &amp;&amp; this.lastName.length &gt; 0);&#xA;    }&#xA;    &#xA;    // Note the function type literal used for the &quot;completeCallback&quot; parameter.&#xA;    // &quot;repository&quot; has no type. Therefore it is of type &quot;Any&quot;.&#xA;    public savePerson(repository, completedCallback: (bool) =&gt; void) {&#xA;      var code = repository.saveViaRestService(this);&#xA;      completedCallback(code === 200);&#xA;    }&#xA;  }&#xA;  &#xA;  // Create derived classes using the &quot;extends&quot; keyword&#xA;  export class VipPerson extends Person {&#xA;    // Note that &quot;VipPerson&quot; does not define a constructor. It gets a&#xA;    // constructor with appropriate parameters from its base class&#xA;    // automatically.&#xA;    &#xA;    // Note how we override &quot;toString&quot; here. Use &quot;super&quot; to access &#xA;    // the base class.&#xA;    public toString() {&#xA;      return super.toString() + &quot; (VIP)&quot;;&#xA;    }&#xA;  }&#xA;  &#xA;  // Define a nested module inside of CrmModule&#xA;  export module Sales {&#xA;    export class Opportunity {&#xA;      public potentialRevenueEur: number;&#xA;      public contacts: IPerson[];      // Array type&#xA;      &#xA;      // Note that we use the &quot;IPerson&quot; interface here.&#xA;      public addContact(p: IPerson) {&#xA;        this.contacts.push(p);&#xA;      }&#xA;      &#xA;      // A static member...&#xA;      static convertToUsd(amountInEur: number): number {&#xA;        return amountInEur * 1.3;&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;&#xA;// Note how we instanciate the Person class here.&#xA;var p: CrmModule.Person;&#xA;p = new CrmModule.Person(&quot;Max&quot;, &quot;Muster&quot;);&#xA;&#xA;// Change the HTML DOM via TypeScript. Try to play around with this code&#xA;// in the TypeScript Playground and you will see that you have IntelliSense&#xA;// when working with the DOM. Accessing the DOM is type safe.&#xA;var button = document.createElement('button')&#xA;button.innerText = p.toString()&#xA;button.onclick = function() {&#xA;  alert(&quot;Hello&quot; + p.firstName)&#xA;}&#xA;document.body.appendChild(button)&#xA;&#xA;// Call a method and pass a callback function.&#xA;var r = { &#xA;  saveViaRestService: function (p: CrmModule.Person) {&#xA;    alert(&quot;Saving &quot; + p.toString());&#xA;    return 200;&#xA;  }&#xA;};&#xA;p.savePerson(r, function(success: string) { alert(&quot;Saved&quot;); });&#xA;&#xA;// Create an instance of the derived class.&#xA;var v: CrmModule.VipPerson;&#xA;v = new CrmModule.VipPerson(&quot;Tom&quot;, &quot;Turbo&quot;);&#xA;// Note how we access the get accessor here.&#xA;if (!v.isValid) {&#xA;  alert(&quot;Person is invalid&quot;);&#xA;}&#xA;else {&#xA;  // Not that &quot;toString&quot; calls the overridden version from the derived class&#xA;  // VipPerson.&#xA;  alert(v.toString());&#xA;}&#xA;&#xA;// Note how we import a module here and assign it the alias &quot;S&quot;.&#xA;import S = CrmModule.Sales;&#xA;var s: S.Opportunity;&#xA;s = new S.Opportunity();&#xA;s.potentialRevenueEur = 1000;&#xA;// Note structural subtyping here. You can call &quot;addContact&quot; with &#xA;// any object type compatible with IPerson.&#xA;s.addContact(v);&#xA;s.addContact({ firstName: &quot;Rainer&quot;, lastName: &quot;Stropek&quot; });&#xA;s.addContact(&lt;CrmModule.IPerson&gt; { firstName: &quot;Rainer&quot;, lastName: &quot;Stropek&quot; });&#xA;var val = S.Opportunity.convertToUsd(s.potentialRevenueEur);&#xA;{% endhighlight %}<h2 xmlns="http://www.w3.org/1999/xhtml">Modules in TypeScript</h2>{% highlight javascript %}module Crm {&#xA;&#x9;export class Customer {&#xA;&#x9;&#x9;constructor(public custName: string) {&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;&#xA;module Crm {&#xA;&#x9;export class Opportunity {&#xA;&#x9;&#x9;constructor(public customer: Customer) {&#xA;&#x9;&#x9;}&#xA;&#x9;}&#x9;&#xA;}&#xA;&#xA;var classesInCrmModule = &quot;&quot;;&#xA;for(var key in Crm)&#xA;{&#xA;&#x9; classesInCrmModule += key + &quot; &quot;;&#xA;&#x9; &#xA;}&#xA;document.body.innerText = classesInCrmModule;&#xA;{% endhighlight %}<h2 xmlns="http://www.w3.org/1999/xhtml">Interfaces and Ambient Declarations</h2><p xmlns="http://www.w3.org/1999/xhtml">The second sample shows the power of <em>Ambient Declarations</em> in TypeScript:</p><p xmlns="http://www.w3.org/1999/xhtml">jQuery.d.ts:</p>{% highlight javascript %}interface JQueryEventObject extends Event {&#xA;  preventDefault(): any;&#xA;}&#xA;&#xA;interface JQuery {&#xA;  ready(handler: any): JQuery;&#xA;  click(handler: (eventObject: JQueryEventObject) =&gt; any): JQuery;&#xA;}&#xA;&#xA;interface JQueryStatic {&#xA;  (element: Element): JQuery;&#xA;  (selector: string, context?: any): JQuery;&#xA;}&#xA;&#xA;declare var $: JQueryStatic;&#xA;{% endhighlight %}<p xmlns="http://www.w3.org/1999/xhtml">app.ts:</p>{% highlight javascript %}/// &lt;reference path=&quot;jQuery.d.ts&quot; /&gt;&#xA;&#xA;$(document.body).ready(function(){&#xA;&#x9;alert(&quot;Loaded&quot;);&#xA;    $(&quot;a&quot;).click(function(event) {&#xA;        alert(&quot;As you can see, the link no longer took you to timecockpit.com&quot;);&#xA;        event.preventDefault();&#xA;   });&#xA;});&#xA;{% endhighlight %}<p xmlns="http://www.w3.org/1999/xhtml">default.htm:</p>{% highlight javascript %}&lt;!DOCTYPE html&gt;&#xA;&lt;html lang=&quot;en&quot; xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&#xA;&lt;head&gt;&#xA;    &lt;meta charset=&quot;utf-8&quot; /&gt;&#xA;    &lt;title&gt;jQuery from TypeScript&lt;/title&gt;&#xA;    &lt;link rel=&quot;stylesheet&quot; href=&quot;app.css&quot; type=&quot;text/css&quot; /&gt;&#xA;    &lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js&quot;&gt;&lt;/script&gt;&#xA;    &lt;script src=&quot;app.js&quot;&gt;&lt;/script&gt;&#xA;&lt;/head&gt;&#xA;&lt;body&gt;&#xA;    &lt;h1&gt;jQuery from TypeScript&lt;/h1&gt;&#xA;    &lt;div id=&quot;content&quot;&gt;&#xA;        &lt;a href=&quot;http://www.timecockpit.com&quot;&gt;Click me!&lt;/a&gt;&#xA;    &lt;/div&gt;&#xA;&lt;/body&gt;&#xA;&lt;/html&gt;{% endhighlight %}