---
layout: blog
title: WPF CheckBox With Confirmation Message
teaser: During BASTA Austria I have been asked a WPF question. How can I implement a confirmation question that is asked whenever a user checks a CheckBox?
author: Rainer Stropek
date: 2012-50-19
bannerimage: 
permalink: /blog/2012/11/19/WPF-CheckBox-With-Confirmation-Message
---

<p xmlns="http://www.w3.org/1999/xhtml">During <a href="http://www.basta-austria.at" title="Homepage of BASTA Austria" target="_blank">BASTA Austria</a> I have been asked a WPF question. How can I implement a confirmation question that is asked whenever a user checks a CheckBox? Imagine the following dialog:</p><p xmlns="http://www.w3.org/1999/xhtml"> <img src="{{site.baseurl}}/content/images/blog/2012/11/CheckboxConfirmation.png" alt="CheckBox Confirmation Sample Dialog" /></p><p xmlns="http://www.w3.org/1999/xhtml">Our goal is to display an "Are you sure?" message if the user checks "Delete everything!" or hits the "Delete Everything (in Code)" button. There should not be a message box if the user unchecks the "Delete everything!" check box.</p><h2 xmlns="http://www.w3.org/1999/xhtml">XAML Source (Without Confirmation Message)</h2><p xmlns="http://www.w3.org/1999/xhtml">Here you see the XAML source with which we start:</p>{% highlight javascript}&lt;Window x:Class=&quot;WpfApplication1.MainWindow&quot;&#xA;        xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;&#xA;        xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;&#xA;        xmlns:i=&quot;http://schemas.microsoft.com/expression/2010/interactivity&quot;  &#xA;        xmlns:local=&quot;clr-namespace:WpfApplication1&quot;&#xA;        Title=&quot;MainWindow&quot; Height=&quot;350&quot; Width=&quot;525&quot;&gt;&#xA;    &lt;StackPanel&gt;&#xA;        &lt;CheckBox Content=&quot;Delete everything!&quot; Name=&quot;DeleteEverythingCheckbox&quot; IsChecked=&quot;{Binding Path=CheckboxChecked}&quot;&#xA;                  Margin=&quot;5&quot;&gt;&#xA;        &lt;/CheckBox&gt;&#xA;        &lt;Button Command=&quot;{Binding Path=SetDeleteEverythingCommand}&quot; Margin=&quot;5&quot;&gt;Delete Everything (in Code)&lt;/Button&gt;&#xA;        &#xA;        &lt;TextBox IsEnabled=&quot;{Binding ElementName=DeleteEverythingCheckbox, Path=IsChecked}&quot; Text=&quot;Here is some text to edit&quot;&#xA;                 Margin=&quot;5&quot;/&gt;&#xA;    &lt;/StackPanel&gt;&#xA;&lt;/Window&gt;&#xA;{% endhighlight %}<p xmlns="http://www.w3.org/1999/xhtml">The code behind file just connects to the view model:</p>{% highlight javascript}using System.Windows;&#xA;&#xA;namespace WpfApplication1&#xA;{&#xA;    public partial class MainWindow : Window&#xA;    {&#xA;        public MainWindow()&#xA;        {&#xA;            InitializeComponent();&#xA;            this.DataContext = new MainWindowViewModel();&#xA;        }&#xA;    }&#xA;}&#xA;{% endhighlight %}<p xmlns="http://www.w3.org/1999/xhtml">And finally here is the view model (I use Prism's <em>NotificationObject</em> class as the base class to get an implementation of <em>INotifyPropertyChanged</em>):</p>{% highlight javascript}using Microsoft.Practices.Prism.Commands;&#xA;using Microsoft.Practices.Prism.ViewModel;&#xA;using System.Windows.Input;&#xA;&#xA;namespace WpfApplication1&#xA;{&#xA;    public class MainWindowViewModel : NotificationObject&#xA;    {&#xA;        public MainWindowViewModel()&#xA;        {&#xA;            this.SetDeleteEverythingCommand = new DelegateCommand(() =&gt;&#xA;                {&#xA;                    this.CheckboxChecked = true;&#xA;                },&#xA;                () =&gt; !this.CheckboxChecked);&#xA;        }&#xA;&#xA;        private bool CheckboxCheckedValue = default(bool);&#xA;        public bool CheckboxChecked&#xA;        {&#xA;            get { return this.CheckboxCheckedValue; }&#xA;            set&#xA;            {&#xA;                if (this.CheckboxCheckedValue != value)&#xA;                {&#xA;                    this.CheckboxCheckedValue = value;&#xA;                    this.RaisePropertyChanged(() =&gt; this.CheckboxChecked);&#xA;                }&#xA;            }&#xA;        }&#xA;       &#xA;        public ICommand SetDeleteEverythingCommand { get; private set; }&#xA;    }&#xA;}&#xA;{% endhighlight %}<h2 xmlns="http://www.w3.org/1999/xhtml">Add a <em>TriggerAction</em> for Showing Confirmation Message</h2><p xmlns="http://www.w3.org/1999/xhtml">
  <em>System.Windows.Interactivity</em> defines a class <em>TriggerAction&lt;T&gt;</em> which we can use to provide a mechanism for adding the confirmation message in XAML. The code is quite simple:</p>{% highlight javascript}using System.Windows;&#xA;using System.Windows.Controls;&#xA;using System.Windows.Input;&#xA;using System.Windows.Interactivity;&#xA;&#xA;namespace WpfApplication1&#xA;{&#xA;    public class ConfirmInvokeCommandAction : TriggerAction&lt;DependencyObject&gt;&#xA;    {&#xA;        public static readonly DependencyProperty MessageProperty =&#xA;            DependencyProperty.Register(&quot;Message&quot;, typeof(string), typeof(ConfirmInvokeCommandAction), new PropertyMetadata(&quot;Are you sure?&quot;));&#xA;&#xA;        public string Message&#xA;        {&#xA;            get { return (string)GetValue(MessageProperty); }&#xA;            set { SetValue(MessageProperty, value); }&#xA;        }&#xA;&#xA;        protected override void Invoke(object parameter)&#xA;        {&#xA;            var checkBox = this.AssociatedObject as CheckBox;&#xA;            if (checkBox != null)&#xA;            {&#xA;                if (MessageBox.Show(this.Message, &quot;Alert&quot;, MessageBoxButton.YesNo) == MessageBoxResult.No)&#xA;                {&#xA;                    checkBox.IsChecked = false;&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;{% endhighlight %}<p xmlns="http://www.w3.org/1999/xhtml">We use an event trigger (mechanism defined in the Expression SDK) to access our <em>TriggerAction</em> in XAML:</p>{% highlight javascript}&lt;Window x:Class=&quot;WpfApplication1.MainWindow&quot;&#xA;        xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;&#xA;        xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;&#xA;        xmlns:i=&quot;http://schemas.microsoft.com/expression/2010/interactivity&quot;  &#xA;        xmlns:local=&quot;clr-namespace:WpfApplication1&quot;&#xA;        Title=&quot;MainWindow&quot; Height=&quot;350&quot; Width=&quot;525&quot;&gt;&#xA;    &lt;StackPanel&gt;&#xA;        &lt;CheckBox Content=&quot;Delete everything!&quot; Name=&quot;DeleteEverythingCheckbox&quot; IsChecked=&quot;{Binding Path=CheckboxChecked}&quot;&#xA;                  Margin=&quot;5&quot;&gt;&#xA;            &lt;i:Interaction.Triggers&gt;&#xA;                &lt;i:EventTrigger EventName=&quot;Checked&quot;&gt;&#xA;                    &lt;local:ConfirmInvokeCommandAction Message=&quot;Are you sure?&quot; /&gt;&#xA;                &lt;/i:EventTrigger&gt;&#xA;            &lt;/i:Interaction.Triggers&gt;&#xA;        &lt;/CheckBox&gt;&#xA;        &lt;Button Command=&quot;{Binding Path=SetDeleteEverythingCommand}&quot; Margin=&quot;5&quot;&gt;Delete Everything (in Code)&lt;/Button&gt;&#xA;        &#xA;        &lt;TextBox IsEnabled=&quot;{Binding ElementName=DeleteEverythingCheckbox, Path=IsChecked}&quot; Text=&quot;Here is some text to edit&quot;&#xA;                 Margin=&quot;5&quot;/&gt;&#xA;    &lt;/StackPanel&gt;&#xA;&lt;/Window&gt;&#xA;{% endhighlight %}<h2 xmlns="http://www.w3.org/1999/xhtml">Result</h2><p xmlns="http://www.w3.org/1999/xhtml">This does the trick:</p><p xmlns="http://www.w3.org/1999/xhtml">
  <img src="{{site.baseurl}}/content/images/blog/2012/11/CheckBoxWithConfirmMessage.png" />
</p><p xmlns="http://www.w3.org/1999/xhtml">If you want to try the solution, <a href="{{site.baseurl}}/content/Blog Assets/Code Samples/CheckBoxConfirmationSource.zip" target="_blank">download the source code</a>.</p>