---
layout: blog
title: Your Data in a Geographical Context
author: Alexander Huber
bannerimage: 
permalink: /2014/04/29/Your-Data-in-a-Geographical-Context
---

<p xmlns="http://www.w3.org/1999/xhtml">Agreed, data is what drives most businesses. However, having a lot of data at your disposal often does not give you much insight. This is because data gains value with the way it is presented. </p><p xmlns="http://www.w3.org/1999/xhtml">In this article, we explain how to set your data in a geographical context. We use Microsoft Excel, Power View and time cockpit's <a href="~/blog/2014/04/27/Adding-Web-to-our-API">brand new OData Web API</a> to create an interactive map that lets you browse your data the way you want.</p><p xmlns="http://www.w3.org/1999/xhtml">
  <img title="Geographical Data in Excel" src="{{site.baseurl}}images/blog/2014/04/ReportNoChrome.png?mw=800" alt="Geographical Data in Excel" />
</p><h2 xmlns="http://www.w3.org/1999/xhtml">What's In It for You?</h2><p xmlns="http://www.w3.org/1999/xhtml">Time cockpit already offers various ways to display your data. First, you can view your data in lists directly in time cockpit. In lists you can filter your data and interactively change the sorting and grouping of the list. If you run into scenarios where you want to represent your data in a nicely formatted, printable report, you can use time cockpit's <a href="~/blog/2014/03/31/Custom-Reporting-in-Time-Cockpit-is-Final">reporting capabilities</a> that were introduced in the April 2014 version of time cockpit. </p><p xmlns="http://www.w3.org/1999/xhtml">But what if you do not want to trade the interactivity of time cockpit list for the advanced formatting capabilities of time cockpit's reporting capabilities? One way to handle the issue is to use time cockpit's <a href="~/blog/2014/04/27/Adding-Web-to-our-API">brand new OData Web API</a>.</p><h2 xmlns="http://www.w3.org/1999/xhtml">The Scenario</h2><p xmlns="http://www.w3.org/1999/xhtml">Imagine that you are overall sales manager for an internationally operating company. Your company has three main revenue drivers: consulting, hosting, and product revenue. Sales figures are not developing as you like in some regions of Europe. You have the data, but you are lacking a compelling way to represent it. Ideally, you like to display your sales figures in a geographical context to get the message to top management.</p><p xmlns="http://www.w3.org/1999/xhtml">Your company uses various BI tools and, of course, Excel. You know your way around those tools, so why not use Excel to present your data the way you want.</p><h2 xmlns="http://www.w3.org/1999/xhtml">Prerequisites</h2><p xmlns="http://www.w3.org/1999/xhtml">For this example to work, you need the following tools:</p><ul xmlns="http://www.w3.org/1999/xhtml">
  <li>Microsoft Excel 2013</li>
  <li>Microsoft Power View (shipped with Excel 2013)</li>
</ul><h2 xmlns="http://www.w3.org/1999/xhtml">Fetching the Data</h2><p xmlns="http://www.w3.org/1999/xhtml">First we need to connect to the time cockpit database to get the data we would like to process in Excel. For that, we use time cockpit's new <a href="~/blog/2014/04/27/Adding-Web-to-our-API">OData Web API</a>. In Excel 2013 you can plug in to different data sources. You can fetch data from a SQL Server (see also this <a href="http://www.linearis.at/blog/2014/01/07/zeiterfassung-in-time-cockpit-mit-power-pivot-analysieren/" target="_blank">article</a>), from an XML File, and also from an OData Data Feed. In this example we consume the OData Feed provided by time cockpit.</p><p xmlns="http://www.w3.org/1999/xhtml">In the <em>DATA</em> tab in Excel click <em>From Other Sources</em> and <em>From OData Data Feed</em> to establish a connection to the time cockpit server. Excel will prompt you for a link where your OData endpoint is hosted. For now, the endpoint is <a href="https://apipreview.timecockpit.com/odata" target="_blank">https://apipreview.timecockpit.com/odata</a>. Excel also asks for your credentials. Please use your time cockpit credentials that you used to initially configure time cockpit or to log in to our website.</p><f:function name="Composite.Media.ImageGallery.Slimbox2" xmlns:f="http://www.composite.net/ns/function/1.0">
  <f:param name="MediaFolder" value="MediaArchive:0816e051-8033-4f5d-9559-6b84e48cf252" xmlns:f="http://www.composite.net/ns/function/1.0" />
  <f:param name="ThumbnailMaxWidth" value="150" xmlns:f="http://www.composite.net/ns/function/1.0" />
</f:function><p class="showcase" xmlns="http://www.w3.org/1999/xhtml">Please keep in mind that this article uses the API preview OData endpoint. The URL <a href="https://apipreview.timecockpit.com/odata" target="_blank">https://apipreview.timecockpit.com/odata</a> is subject to change and will be replaced with another URL in the near future.</p><p xmlns="http://www.w3.org/1999/xhtml">When you have successfully authenticated with our OData endpoint, Excel will present you a list of all database tables that are available for processing in Excel. In this example, we will only fetch two tables: APP_Timesheet and APP_Project. When you click <em>Next</em>, Excel asks you for a name for your OData connection. Since we are fetching timesheets and projects, we simply call it <em>TimesheetsAndProjects</em>. Click <em>Finish</em> and Excel will start to load your time cockpit data into Excel.</p><f:function name="Composite.Media.ImageGallery.Slimbox2" xmlns:f="http://www.composite.net/ns/function/1.0">
  <f:param name="MediaFolder" value="MediaArchive:8cc34d72-b3b4-4fb6-833e-90d3d5f010f6" xmlns:f="http://www.composite.net/ns/function/1.0" />
  <f:param name="ThumbnailMaxWidth" value="150" xmlns:f="http://www.composite.net/ns/function/1.0" />
</f:function><p xmlns="http://www.w3.org/1999/xhtml">Loading your data from the web may take a while. How long it takes depends of the amount of data you are loading. After Excel has finished to load the data it will ask you how to present the data it fetched in Excel. You can show your data for example as normal <em>Table</em> or as <em>PivotTable</em>. In this example we will use our data in a simple Excel table.</p><p xmlns="http://www.w3.org/1999/xhtml">
  <img src="{{site.baseurl}}images/blog/2014/04/ChoosingDataView.png" />
</p><p xmlns="http://www.w3.org/1999/xhtml">Excel will load the data from the OData endpoint and drop it into an existing worksheet. We have all the necessary data in Excel now and can continue formatting it in a more meaningful way.</p><h2 xmlns="http://www.w3.org/1999/xhtml">Presenting the Data</h2><p xmlns="http://www.w3.org/1999/xhtml">It is time now to present your data in a more visual way than in a table. To load your data into Power View, mark the table containing the time sheet entries and switch to the <em>INSERT</em> tab in the Excel ribbon menu. While still having marked your table, click <em>Power View</em> in the ribbon. If this is the first time you use Power View, Excel will automatically load the necessary components. After Excel has loaded the components it will open a new worksheet for you displaying the data of your table in the Power View worksheet.</p><p xmlns="http://www.w3.org/1999/xhtml">
  <img src="{{site.baseurl}}images/blog/2014/04/PowerViewInitialView.png?mw=800" />
</p><p xmlns="http://www.w3.org/1999/xhtml">In the <em>Table Fields</em> area you can choose which fields of your selected table to display in the Power View visualization area. Per default, Excel will choose fields that are not very helpful for our scenario. For us, the three important fields are Location, Revenue Category and of course the sum of the revenue per location and revenue category. So we add only these three fields to the Power View visualization area by selecting them in the <em>Table Fields</em> area.</p><p xmlns="http://www.w3.org/1999/xhtml">To display the data in geographical context you select the Power View visualization area and click <em>Map</em> in the <em>DESIGN</em> tab in the ribbon. Excel will present you with a visualization proposal that does not quite fit our needs. To visualize the data in a more useful way, drag the location fields from <em>VERTICAL MULITPLIES</em> to <em>LOCATIONS</em>.</p><p xmlns="http://www.w3.org/1999/xhtml">
  <img src="{{site.baseurl}}images/blog/2014/04/ConfiguringMap.png?mw=800" />
</p><p xmlns="http://www.w3.org/1999/xhtml">Having told Excel which fields holds the location information aggregates you sales figures in one single map. Automatically, Excel creates pie charts for the revenue of each location. The size of the pie charts is determined by the revenue. The color of the different parts of the pie chart is determined by the revenue category.</p><p xmlns="http://www.w3.org/1999/xhtml">You can now start to design the visual report by adding for example additional filters. Add additional filters by dragging the fields you want to filter for from the <em>Table Fields</em> area in the <em>Filters</em> area. In this example, we have added filters for location and revenue. Note that Excel provides meaningful controls for each filter type. Revenue, for example, represent a number. Thus, Excel renders a slider where you can configure the range of revenue you want to see in your map. Location, on the other hand, is as text field. Thus, Excel presents you a list of all possible locations and you can choose which ones to display in the map.</p><p xmlns="http://www.w3.org/1999/xhtml">
  <img src="{{site.baseurl}}images/blog/2014/04/FinishedMap.png?mw=800" />
</p><p xmlns="http://www.w3.org/1999/xhtml">Now you can view your sales figures in a map in Excel and can interactively change what data you would like to show. You can, for example, decide to view only certain countries that are in a given revenue range. Power View will automatically update the data in your map.</p><h2 xmlns="http://www.w3.org/1999/xhtml">Summary</h2><p xmlns="http://www.w3.org/1999/xhtml">In this article we described a simple scenario how to consume data from time cockpit's <a href="~/blog/2014/04/27/Adding-Web-to-our-API">OData Web API</a> and process it in Excel. We used Excel Power View to create interactive reports that facilitate the Bing Maps engine. This different approach should help you to present your data in a more expressive and fancy ;-) way and gain more insight into the figures that drive your business. </p><h2 xmlns="http://www.w3.org/1999/xhtml">Further Reading</h2><ul xmlns="http://www.w3.org/1999/xhtml">
  <li>
    <a href="http://office.microsoft.com/en-001/videos/video-maps-in-power-view-VA104017433.aspx?CTT=5&amp;origin=HA104009784" title="Microsoft Excel Power Viewer" target="_blank">Microsoft Excel Power View</a>
    <a href="http://office.microsoft.com/en-001/videos/video-maps-in-power-view-VA104017433.aspx?CTT=5&amp;origin=HA104009784" target="_blank"></a>
  </li>
  <li>
    <a href="http://www.timecockpit.com/blog/2014/04/27/Adding-Web-to-our-API" title="Introduction to the New Web API">Introduction to the New Web API</a>
  </li>
  <li>
    <a href="https://help.timecockpit.com/?topic=html/5d6e34c5-3b08-4fa4-baa0-45eb707b6b78.htm" title="Web API Documentation" target="_blank">Web API Documentation</a>
  </li>
</ul>